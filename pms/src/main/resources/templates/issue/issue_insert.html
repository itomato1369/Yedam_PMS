<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org/"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default_layout}"
	layout:fragment="Content">
<head>
<meta charset="UTF-8" />
<!-- bootstrap-datepicker -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.min.css" />

<!-- 1. jQuery = JavaScript 라이브러리-->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<!-- 2. bootstrap-datepicker 본체 -->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js"></script>
<!-- 3. 한국어 캘린더-->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/locales/bootstrap-datepicker.ko.min.js"></script>
<title>일감 등록</title>
</head>
<body>
	<div class="container">
		<form id="issueInsert" enctype="multipart/form-data" method="post">
			<!-- 제목 -->
			<div class="mb-3">
				<label class="form-label">제목</label> <input type="text"
					class="form-control mt-2" name="title" placeholder="제목을 입력하세요" />
			</div>

			<!-- 상태 -->
			<!-- th:value는 서버로 보내는 값 th:text는 사용자에게 보여주는 값 -->
			<div class="row mb-3">
				<div class="col-md-6">
					<label class="form-label">일감 상태</label> <select class="form-select"
						name="status">
						<option value="">선택</option>
						<option th:each="status : ${statusList}" th:value="${status}"
							th:text="${status}"></option>
					</select>
				</div>

				<!-- 유형 -->
				<div class="col-md-6">
					<label class="form-label">일감 유형</label> <select class="form-select"
						name="type">
						<option value="">선택</option>
						<option th:each="type : ${typeList}" th:value="${type}"
							th:text="${type}"></option>
					</select>
				</div>
			</div>

			<!-- 상세 설명 -->
			<div class="mb-3">
				<label class="form-label">상세 설명</label>
				<div class="form-floating">
					<textarea class="form-control" placeholder="상세 설명을 입력하세요"
						id="floatingTextarea2" style="height: 100px" name="content"></textarea>
					<label for="floatingTextarea2"></label>
				</div>
			</div>

			<div class="row mb-3">
				<!-- 우선순위 -->
				<div class="col-md-6">
					<label class="form-label">우선순위</label> <select class="form-select"
						name="priority">
						<option value="">선택</option>
						<option th:each="priority : ${priorityList}"
							th:value="${priority}" th:text="${priority}"></option>
					</select>
				</div>

				<!-- 담당자 -->
				<!-- data-bs-toggle과 target은 Bootstrap5 문법 -->
				<div class="col-md-6">
					<button type="button" class="btn btn-outline-primary"
						data-bs-toggle="modal" data-bs-target="#userSelectModal">
						담당자 선택</button>
					<input type="text" class="form-control" id="managerId"
						name="managerId" readonly />
				</div>
			</div>

			<div class="row mb-3">
				<!-- 시작일 -->
				<div class="col-md-6">
					<label class="form-label">시작일</label><input type="text"
						class="form-control datepicker" id="startDate" name="startDate"
						placeholder="시작 날짜 선택" readonly />
				</div>

				<!-- 마감일 -->
				<div class="col-md-6">
					<label class="form-label">마감일</label><input type="text"
						class="form-control datepicker" id="endDate" name="endDate"
						placeholder="마감 날짜 선택" readonly />
				</div>
			</div>

			<div class="row mb-3">
				<!-- 상위 일감 -->
				<div class="col-md-6">
					<button type="button" class="btn btn-outline-primary"
						data-bs-toggle="modal" data-bs-target="#issueSelectModal">
						상위일감 선택</button>
					<input type="text" class="form-control" id="jobId" name="jobId"
						readonly />
				</div>

				<!-- 진척도 -->
				<div class="col-md-6">
					<label class="form-label">진척도</label> <select class="form-select"
						name="progress">
						<option value="">선택</option>
						<option th:each="p : ${#numbers.sequence(0, 10)}" th:value="${p}"
							th:text="${(p * 10) + '%'}"></option>
					</select>
					<div class="form-text text-muted">처음 등록하는 일감인 경우 진척도를 0으로 설정해 주세요</div>
				</div>
			</div>

			<div class="row mb-3 align-items-center">
				<!-- 첨부파일 -->
				<div class="col-md-6">
					<label for="formFile" class="form-label">첨부파일</label> <input
						class="form-control" type="file" id="files" name="files" multiple />
					<!-- 여러개 선택시 첨부파일 이름이 표시 -->
					<ul id="fileList" class="mt-2 list-group"></ul>
				</div>

				<!-- 공개범위 -->
				<div class="col-md-5 d-flex flex-column justify-content-center">
					<label class="form-label mb-2">공개범위</label>

					<div class="d-flex gap-5">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="publicRole"
								id="public" value="public" /> <label
								class="form-check-label" for="public">전체공개</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" name="publicRole"
								id="private" value="private" /> <label
								class="form-check-label" for="private">일부공개</label>
						</div>
					</div>
				</div>
			</div>

			<!-- 전송 -->
			<div class="row md-3">
				<button type="button" class="btn btn-primary" data-bs-toggle="modal"
					data-bs-target="#issueSubmitModal">등록</button>
			</div>
		</form>
	</div>

	<!-- 모달 fragment 호출 ~{템플릿 재사용 fragment 호출 조각 표현식} -->
	<th:block
		th:replace="~{common/fragments/issue/user_select_modal :: UserSelectModal}"></th:block>
	<th:block
		th:replace="~{common/fragments/issue/issue_select_modal :: IssueSelectModal}"></th:block>
	<th:block
		th:replace="~{common/fragments/issue/issue_submit_modal :: IssueSubmitModal}"></th:block>

	<script th:src="@{/js/issue/issue_insert.js}"></script>
</body>
</html>
